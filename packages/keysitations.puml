@startuml
package KeySituations #e8faffff {
  class KeySituation {
    +id: int
    +userId: int
    +timestamp: DateTime
    +mechanicId: int
    +screen: String
    +value: float
    +metadata: Map<String, String>
  }

  class MechanicKeySituation {
    +id: int
  
  }
  class GeneralKeySituation {
    +id: int
    
  }
  class ProgramrelatedKeySituation {
    +id: int
  }
  ProgramrelatedKeySituation <|-- GeneralKeySituation 

  class SessionRelatedKeySituation {
    +id: int
  }
  SessionRelatedKeySituation <|-- GeneralKeySituation 

  GeneralKeySituation <|-- KeySituation 
  MechanicKeySituation <|-- KeySituation

  object TaskFinished
  TaskFinished : ProgramrelatedKeySituation
  TaskFinished --> ProgramrelatedKeySituation : "instance of"

  object MechanicDisplayed
  MechanicDisplayed : MechanicKeySituation
  MechanicDisplayed --> MechanicKeySituation : "instance of"

  object MechanicInteraction
  MechanicInteraction : MechanicKeySituation
  MechanicInteraction --> MechanicKeySituation : "instance of"

  object SessionStarted
  SessionStarted : SessionRelatedKeySituation
  SessionStarted --> SessionRelatedKeySituation : "instance of"

  object TaskStarted
  TaskStarted : ProgramrelatedKeySituation
  TaskStarted --> ProgramrelatedKeySituation : "instance of"

  object TaskEnded
  TaskEnded : ProgramrelatedKeySituation
  TaskEnded --> ProgramrelatedKeySituation : "instance of"

  object SessionEnded
  SessionEnded : SessionRelatedKeySituation
  SessionEnded --> SessionRelatedKeySituation : "instance of"

  object ScreenEntered
  ScreenEntered : GeneralKeySituation
  ScreenEntered --> GeneralKeySituation : "instance of"

  note left of KeySituation
  Generic KeySituation structure used for multiple behavioral logs,
  such as screen visits, mechanic usage, and session tracking.
  end note

  note left of GeneralKeySituation
  Used for logs unrelated to specific game mechanics, such as 
  screen visits, general engagement, or app usage.
  end note

  note left of MechanicKeySituation
  Used for mechanic-specific behavioral tracking, including
  mechanic activation, frequency, success/failure, and feedback.
  end note
}
Program_and_Tasks.Program --> KeySituation : "triggers"
Metrics_and_Measurements.Adherence --> KeySituations.TaskFinished : "informedBy"
@enduml